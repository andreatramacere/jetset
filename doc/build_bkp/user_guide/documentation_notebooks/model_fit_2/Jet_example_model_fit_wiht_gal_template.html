
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Model fitting 2: SSC + galaxy template &#8212; jetset  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=a93b4d3c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/documentation_notebooks/model_fit_2/Jet_example_model_fit_wiht_gal_template';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Model fitting 3: External Compton" href="../model_fit_3/Jet_example_model_fit_EC.html" />
    <link rel="prev" title="Model fitting 1: Only SSC" href="../model_fit_1/Jet_example_model_fit.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo_large_no_border.png" class="logo__image only-light" alt="JetSeT "/>
    <script>document.write(`<img src="../../../_static/logo_large_no_border.png" class="logo__image only-dark" alt="JetSeT "/>`);</script>
  
  
    <p class="title logo__title">documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/andreatramacere/jetset" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../new_release.html">changelog</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../user_guide.html">user guide</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../model_basic.html">model basic features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html"> jet model physical setup (basic features and SSC) -  *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../jet_model_phys_EC/Jet_example_phys_EC.html">External Compton</a></li>

<li class="toctree-l3"><a class="reference internal" href="../jet_model_num/Jet_example_num.html"> jet model numerical setup - *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hadronic_pp_jet/hadronic.html"> jet hadronic pp model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../galactic/galactic.html"> galactic beamed/unbeamed objects - *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cosmology/Jet_example_cosmo.html"> change cosmology model - *New (v1.3.0)*</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../model_advanced.html">model advanced features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../composite_model/Composite_model.html"> composite models  *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../depending_pars/depending_pars.html"> depending parameters  *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html"> jet model custom  emitters distributions *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../EBL/EBL.html"> EBL models  *New (v1.2.0)*</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../data_and_phenomenology.html">data and phenomenology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../load_data/Jet_example_load_data.html"> data format</a></li>
<li class="toctree-l3"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html"> phenomenological model constraining: theoretical background on SSC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../phen_constr/Jet_example_phenom_constr.html"> phenomenological model constraining: application</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../model_fitting.html">model fitting</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../model_fitting_intro.html"> caveats and introduction on model fitting and minimizers</a></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../../model_fitting_examples.html"> model fitting examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../model_fit_1/Jet_example_model_fit.html"> 1: SSC model fit, minuit contours, and MCMC for Mrk 421 *New (v1.3.0)*</a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#"> 2: SSC (jet+galaxy template) model fit and MCMC for Mrk 501 *New (v1.3.0)*</a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_fit_3/Jet_example_model_fit_EC.html"> 3: SSC and EC fit for 3C 454.3 *New (v1.3.0)*</a></li>
<li class="toctree-l4"><a class="reference internal" href="../model_fit_4/Jet_example_only_synchrotron.html"> 4: Only Synchroton for Mrk 421 fit, minuit contours, and MCMC *New (v1.3.0)*</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html"> 5: Mrk 521 SSC+EBL with Sherpa plugin and jetset interface  *New (v1.3.0)*</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../temp_ev.html">temporal evolution</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../temporal_evolution/Temp_Ev_one_zone_only_cooling.html"> Temporal evolution, one zone, only cooling *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling.html"> Temporal evolution, two zones,  cooling+acc *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.html"> Temporal evolution, two zones,  cooling+acc+adiabatic expansion *New (v1.2.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hadronic_pp_jet/hadronic_validate_temp_ev.html"> Temporal evolution, validation of the hadronic pp secondaries evolution *New (v1.2.0)*</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../plugins.html">plugins</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html"> Example to use the sherpa plugin with the Sherpa interface *New (v1.3.0)*</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html"> Example to use the Gamma-py plugin with the JeSeT interface *New (v1.3.0)*</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api/modules.html">code documentation (API)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/analytical_model.html">analytical_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.analytical_model.AnalyticalParameter.html">AnalyticalParameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.analytical_model.Disk.html">Disk</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/base_model.html">base_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.base_model.Model.html">Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.base_model.MultiplicativeModel.html">MultiplicativeModel</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/convert_qdp.html">convert_qdp</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.convert_qdp.check_is_number.html">check_is_number</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.convert_qdp.do_convert.html">do_convert</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/cosmo_tools.html">cosmo_tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.cosmo_tools.Cosmo.html">Cosmo</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/data_loader.html">data_loader</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.data_loader.get_data_set_msk.html">get_data_set_msk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.data_loader.get_freq_range_msk.html">get_freq_range_msk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.data_loader.lin_to_log.html">lin_to_log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.data_loader.log_to_lin.html">log_to_lin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.data_loader.ObsData.html">ObsData</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.data_loader.Data.html">Data</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/frame_converter.html">frame_converter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.frame_converter.convert_nu_to_blob.html">convert_nu_to_blob</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.frame_converter.convert_nu_to_src.html">convert_nu_to_src</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.frame_converter.convert_nuFnu_to_nuLnu_src.html">convert_nuFnu_to_nuLnu_src</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/gammapy_plugin.html">gammapy_plugin</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.gammapy_plugin.GammapyJetsetModelFactory.html">GammapyJetsetModelFactory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.gammapy_plugin.GammapyJetsetModel.html">GammapyJetsetModel</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jet_emitters.html">jet_emitters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_emitters.EmittersDistribution.html">EmittersDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_emitters.BaseEmittersDistribution.html">BaseEmittersDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_emitters.ArrayDistribution.html">ArrayDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_emitters.EmittersArrayDistribution.html">EmittersArrayDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_emitters.InjEmittersDistribution.html">InjEmittersDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_emitters.JetkernelEmittersDistribution.html">JetkernelEmittersDistribution</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jet_emitters_factory.html">jet_emitters_factory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_emitters_factory.EmittersFactory.html">EmittersFactory</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jet_kernel_tools.html">jet_kernel_tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_kernel_tools.get_spectral_c_array.html">get_spectral_c_array</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jet_model.html">jet_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_model.Jet.html">Jet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_model.JetBase.html">JetBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_model.GalacticBeamed.html">GalacticBeamed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_model.GalacticUnbeamed.html">GalacticUnbeamed</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jet_paramters.html">jet_paramters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_paramters.JetParameter.html">JetParameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_paramters.JetModelDictionaryPar.html">JetModelDictionaryPar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_paramters.JetModelParameterArray.html">JetModelParameterArray</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jet_spectral_components.html">jet_spectral_components</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_spectral_components.JetSeedPhotons.html">JetSeedPhotons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_spectral_components.JetSpecComponent.html">JetSpecComponent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_spectral_components.SpecCompList.html">SpecCompList</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jet_timedep.html">jet_timedep</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_timedep.merge_lcs.html">merge_lcs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_timedep.JetTimeEvol.html">JetTimeEvol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_timedep.TimeEmittersDistribution.html">TimeEmittersDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_timedep.TimeEvolvingRegion.html">TimeEvolvingRegion</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jet_tools.html">jet_tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_tools.build_emitting_region_dict.html">build_emitting_region_dict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_tools.build_ExtFields_dic.html">build_ExtFields_dic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_tools.BLR_constraints.html">BLR_constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_tools.DT_constraints.html">DT_constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.jet_tools.clean_numba.html">clean_numba</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/jetkernel_models_dic.html">jetkernel_models_dic</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/loglog_poly_model.html">loglog_poly_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.loglog_poly_model.find_max_cubic.html">find_max_cubic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.loglog_poly_model.LogCubic.html">LogCubic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.loglog_poly_model.LogLinear.html">LogLinear</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.loglog_poly_model.LogLogModel.html">LogLogModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.loglog_poly_model.LogParabolaEp.html">LogParabolaEp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.loglog_poly_model.LogParabolaPL.html">LogParabolaPL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.loglog_poly_model.PolyParameter.html">PolyParameter</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/mathkernel_helper.html">mathkernel_helper</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/mcmc.html">mcmc</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.mcmc.McmcSampler.html">McmcSampler</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/minimizer.html">minimizer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.minimizer.fit_SED.html">fit_SED</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.minimizer.FitResults.html">FitResults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.minimizer.Minimizer.html">Minimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.minimizer.LSBMinimizerScipy.html">LSBMinimizerScipy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.minimizer.MinuitMinimizer.html">MinuitMinimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.minimizer.ModelMinimizer.html">ModelMinimizer</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/model_manager.html">model_manager</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.model_manager.FitModel.html">FitModel</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/model_parameters.html">model_parameters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.model_parameters.ModelParameter.html">ModelParameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.model_parameters.ModelParameterArray.html">ModelParameterArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.model_parameters.Value.html">Value</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/obs_constrain.html">obs_constrain</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.check_boundaries.html">check_boundaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.check_t_var.html">check_t_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.constr_B_from_nu_peaks.html">constr_B_from_nu_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.constr_R_from_CD.html">constr_R_from_CD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.find_B_from_nu_p_S.html">find_B_from_nu_p_S</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.find_gamma0.html">find_gamma0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.find_gamma_3p_SSC.html">find_gamma_3p_SSC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.find_gamma_Synch.html">find_gamma_Synch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.find_HE_cut_off.html">find_HE_cut_off</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.find_s.html">find_s</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.find_s1.html">find_s1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.find_turn_over.html">find_turn_over</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.get_Comp_factor.html">get_Comp_factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.get_R_tvar.html">get_R_tvar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.get_U_Sync_from_Ph.html">get_U_Sync_from_Ph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.rescale_Ne.html">rescale_Ne</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.set_gmin_from_nu_cut_IR.html">set_gmin_from_nu_cut_IR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.obs_constrain.ObsConstrain.html">ObsConstrain</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/output.html">output</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.output.clean_dir.html">clean_dir</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.output.makedir.html">makedir</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.output.WorkPlace.html">WorkPlace</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/plot_sedfit.html">plot_sedfit</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.plot_sedfit.PlotSED.html">PlotSED</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.plot_sedfit.BasePlot.html">BasePlot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.plot_sedfit.PlotPdistr.html">PlotPdistr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.plot_sedfit.PlotSpecComp.html">PlotSpecComp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.plot_sedfit.PlotSeedPhotons.html">PlotSeedPhotons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.plot_sedfit.PlotSpectralMultipl.html">PlotSpectralMultipl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.plot_sedfit.PlotTempEvDiagram.html">PlotTempEvDiagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.plot_sedfit.PlotTempEvEmitters.html">PlotTempEvEmitters</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/poly_fit.html">poly_fit</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.check_maxima.html">check_maxima</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.cubic_peaks.html">cubic_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.do_cubic_fit.html">do_cubic_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.do_cubic_fit_peaks.html">do_cubic_fit_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.do_linear_fit.html">do_linear_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.do_log_Parab_FIT.html">do_log_Parab_FIT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.filter_interval.html">filter_interval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.find_max_cubic.html">find_max_cubic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.lin.html">lin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.parab.html">parab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.residuals_cubic_peaks.html">residuals_cubic_peaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.residuals_linfit.html">residuals_linfit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit.residuals_parab.html">residuals_parab</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/poly_fit_tools.html">poly_fit_tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit_tools.get_SED_log_par_fit.html">get_SED_log_par_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit_tools.get_SED_pl_fit.html">get_SED_pl_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit_tools.get_n_gamma_log_par_fit.html">get_n_gamma_log_par_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.poly_fit_tools.get_nu_p_S_delta_approx.html">get_nu_p_S_delta_approx</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/sed_shaper.html">sed_shaper</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.filter_interval.html">filter_interval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.find_E0.html">find_E0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.IC_fit_range.html">IC_fit_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.spectral_index_range.html">spectral_index_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.sync_fit_range.html">sync_fit_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.index.html">index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.index_array.html">index_array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.index_typecasting.html">index_typecasting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.peak_values.html">peak_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sed_shaper.SEDShape.html">SEDShape</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/sherpa_plugin.html">sherpa_plugin</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sherpa_plugin.plot_sherpa_model.html">plot_sherpa_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.sherpa_plugin.JetsetSherpaModel.html">JetsetSherpaModel</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/spectral_shapes.html">spectral_shapes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.spectral_shapes.SED.html">SED</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/template_2Dmodel.html">template_2Dmodel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.template_2Dmodel.TemplateTable2D.html">TemplateTable2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.template_2Dmodel.EBLAbsorptionTemplate.html">EBLAbsorptionTemplate</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/template_model.html">template_model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.template_model.SpectralTemplateLogLog.html">SpectralTemplateLogLog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.template_model.TemplateParameter.html">TemplateParameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.template_model.BigBlueBumpTemplateLogLog.html">BigBlueBumpTemplateLogLog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.template_model.HostGalaxyTemplateLogLog.html">HostGalaxyTemplateLogLog</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/test_data_helper.html">test_data_helper</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/utils.html">utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.utils.check_frame.html">check_frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.utils.unexpected_behaviour.html">unexpected_behaviour</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/version_notifier.html">version_notifier</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.version_notifier.check_version.html">check_version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.version_notifier.run_version_checking.html">run_version_checking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jetset.version_notifier.capture.html">capture</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">bibliography</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">New/updated in v 1.2.0-1.3.0:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../depending_pars/depending_pars.html">Depending parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composite_model/Composite_model.html">Composite Models and depending pars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_emitters_distr/custom_emitters.html">Custom emitters distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jet_model_phys_SSC/Jet_example_phys_SSC.html">Physical setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hadronic_pp_jet/hadronic.html">Hadronic pp jet model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_one_zone_only_cooling.html">Temporal evolution, one zone, only cooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling.html">Temporal evolution, two zones, cooling+acc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal_evolution/Temp_Ev_two_zones_acc_and_cooling_adb_exp.html">Temporal evolution, two zones, cooling+acc+adb exp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phen_constr/SSC_th_bkg.html">Phenomenological model constraining: SSC theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-sherpa-interface.html">Example to use the Sherpa plugin with the sherpa interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sherpa_plugin/sherpa-plugin-jetset-interface.html">Example to use the Sherpa minimizer plugin with a JeSeT model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gammapy_plugin/gammapy_plugin.html">Example to use the Gamma-py plugin with the JeSeT interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../galactic/galactic.html">Galactic object models</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/user_guide/documentation_notebooks/model_fit_2/Jet_example_model_fit_wiht_gal_template.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Model fitting 2: SSC + galaxy template</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-data">Loading data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phenomenological-model-constraining">Phenomenological model constraining</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-indices">Spectral indices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed-shaper">Sed shaper</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-constraining">Model constraining</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting-procedure">Model fitting procedure</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting-with-lsb">Model fitting with LSB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting-with-minuit">Model fitting with Minuit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting-with-a-bkn-pl">Model fitting with a bkn pl</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mcmc-sampling">MCMC sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-reuse-mcmc">Save and reuse MCMC</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="model-fitting-2-ssc-galaxy-template">
<span id="model-fitting-2"></span><h1>Model fitting 2: SSC + galaxy template<a class="headerlink" href="#model-fitting-2-ssc-galaxy-template" title="Link to this heading">#</a></h1>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">jetset</span>
<span class="kn">from</span> <span class="nn">jetset.test_data_helper</span> <span class="kn">import</span>  <span class="n">test_SEDs</span>
<span class="kn">from</span> <span class="nn">jetset.data_loader</span> <span class="kn">import</span> <span class="n">ObsData</span><span class="p">,</span><span class="n">Data</span>
<span class="kn">from</span> <span class="nn">jetset.plot_sedfit</span> <span class="kn">import</span> <span class="n">PlotSED</span>
<span class="kn">from</span> <span class="nn">jetset.test_data_helper</span> <span class="kn">import</span>  <span class="n">test_SEDs</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">jetset</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.3.0</span><span class="n">rc7</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_SEDs</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;/Users/orion/miniforge3/envs/jetset/lib/python3.10/site-packages/jetset/test_data/SEDs_data/SED_3C345.ecsv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/Users/orion/miniforge3/envs/jetset/lib/python3.10/site-packages/jetset/test_data/SEDs_data/SED_MW_Mrk421_EBL_DEABS.ecsv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/Users/orion/miniforge3/envs/jetset/lib/python3.10/site-packages/jetset/test_data/SEDs_data/SED_MW_Mrk501_EBL_ABS.ecsv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/Users/orion/miniforge3/envs/jetset/lib/python3.10/site-packages/jetset/test_data/SEDs_data/SED_MW_Mrk501_EBL_DEABS.ecsv&#39;</span><span class="p">]</span>
</pre></div>
</div>
<section id="loading-data">
<h2>Loading data<a class="headerlink" href="#loading-data" title="Link to this heading">#</a></h2>
<p>see the <span class="xref std std-ref">data_format</span> user guide for further information about loading data</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">test_SEDs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">sed_data</span><span class="o">=</span><span class="n">ObsData</span><span class="p">(</span><span class="n">data_table</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">sed_data</span><span class="o">.</span><span class="n">group_data</span><span class="p">(</span><span class="n">bin_width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">sed_data</span><span class="o">.</span><span class="n">add_systematics</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,[</span><span class="mf">10.</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span><span class="mf">10.</span><span class="o">**</span><span class="mi">29</span><span class="p">])</span>
<span class="n">p</span><span class="o">=</span><span class="n">sed_data</span><span class="o">.</span><span class="n">plot_sed</span><span class="p">()</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>*  binning data  *</strong>
---&gt; N bins= 90
---&gt; bin_widht= 0.2
msk [False  True False  True  True  True  True  True False False False  True
 False False False False False False False False False False False False
 False  True  True  True  True  True  True False False False False False
 False False  True  True  True  True False  True  True  True  True  True
  True False  True False False False False False False False False False
 False False False False False False  True False  True False  True False
  True False  True False  True False False False False False  True  True
  True  True  True  True  True False]
================================================================================</pre>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_8_1.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_8_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sed_data</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;Mrk_501.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="phenomenological-model-constraining">
<h2>Phenomenological model constraining<a class="headerlink" href="#phenomenological-model-constraining" title="Link to this heading">#</a></h2>
<p>see the <a class="reference internal" href="../phen_constr/Jet_example_phenom_constr.html#phenom-constr"><span class="std std-ref">Phenomenological model constraining: application</span></a> user guide for further information about loading data</p>
<section id="spectral-indices">
<h3>Spectral indices<a class="headerlink" href="#spectral-indices" title="Link to this heading">#</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.sed_shaper</span> <span class="kn">import</span>  <span class="n">SEDShape</span>
<span class="n">my_shape</span><span class="o">=</span><span class="n">SEDShape</span><span class="p">(</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">my_shape</span><span class="o">.</span><span class="n">eval_indices</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">plot_indices</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">,</span><span class="n">y_max</span><span class="o">=</span><span class="mf">1E-6</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>* evaluating spectral indices for data *</strong>
================================================================================</pre>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_13_1.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_13_1.png" />
</section>
<section id="sed-shaper">
<h3>Sed shaper<a class="headerlink" href="#sed-shaper" title="Link to this heading">#</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mm</span><span class="p">,</span><span class="n">best_fit</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">sync_fit</span><span class="p">(</span><span class="n">check_host_gal_template</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">Ep_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">minimizer</span><span class="o">=</span><span class="s1">&#39;lsb&#39;</span><span class="p">,</span>
  <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
  <span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">10.</span> <span class="p">,</span> <span class="mf">21.</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>* Log-Polynomial fitting of the synchrotron component *</strong>
---&gt; first blind fit run,  fit range: [10.0, 21.0]
---&gt; class:  HSP

---&gt; class:  HSP</pre>
<i>Table length=6</i>
<table id="table5736199264-56934" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>LogCubic</td><td>b</td><td>-6.522794e-02</td><td>-6.522794e-02</td><td>5.892905e-03</td><td>--</td><td>-4.913172e-02</td><td>-1.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
<tr><td>LogCubic</td><td>c</td><td>-1.908748e-03</td><td>-1.908748e-03</td><td>8.488797e-04</td><td>--</td><td>5.440153e-03</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Ep</td><td>1.704833e+01</td><td>1.704833e+01</td><td>6.858392e-02</td><td>--</td><td>1.593204e+01</td><td>0.000000e+00</td><td>3.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Sp</td><td>-1.030052e+01</td><td>-1.030052e+01</td><td>1.424853e-02</td><td>--</td><td>-1.022242e+01</td><td>-3.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>-1.008538e+01</td><td>-1.008538e+01</td><td>2.900917e-02</td><td>--</td><td>-1.022242e+01</td><td>-1.222242e+01</td><td>-8.222416e+00</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>1.934519e-02</td><td>1.934519e-02</td><td>1.919833e-03</td><td>--</td><td>0.000000e+00</td><td>-5.000000e-01</td><td>5.000000e-01</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5736199264-56934').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5736199264-56934').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---&gt;</span> <span class="n">sync</span>       <span class="n">nu_p</span><span class="o">=+</span><span class="mf">1.704833e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">6.858392e-02</span><span class="p">)</span>  <span class="n">nuFnu_p</span><span class="o">=-</span><span class="mf">1.030052e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">1.424853e-02</span><span class="p">)</span> <span class="n">curv</span><span class="o">.=-</span><span class="mf">6.522794e-02</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">5.892905e-03</span><span class="p">)</span>
<span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_shape</span><span class="o">.</span><span class="n">IC_fit</span><span class="p">(</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">23.</span><span class="p">,</span> <span class="mf">29.</span><span class="p">],</span><span class="n">minimizer</span><span class="o">=</span><span class="s1">&#39;minuit&#39;</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">plot_shape_fit</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>* Log-Polynomial fitting of the IC component *</strong>
---&gt; fit range: [23.0, 29.0]
---&gt; LogCubic fit
====&gt; simplex
====&gt; migrad
====&gt; simplex
====&gt; migrad
====&gt; simplex
====&gt; migrad</pre>
<i>Table length=4</i>
<table id="table5736199120-910386" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>LogCubic</td><td>b</td><td>-1.323324e-01</td><td>-1.323324e-01</td><td>3.154579e-02</td><td>--</td><td>-1.000000e+00</td><td>-1.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
<tr><td>LogCubic</td><td>c</td><td>-3.389147e-02</td><td>-3.389147e-02</td><td>2.022657e-02</td><td>--</td><td>-1.000000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Ep</td><td>2.550950e+01</td><td>2.550950e+01</td><td>2.190510e-01</td><td>--</td><td>2.555059e+01</td><td>0.000000e+00</td><td>3.000000e+01</td><td>False</td></tr>
<tr><td>LogCubic</td><td>Sp</td><td>-1.057957e+01</td><td>-1.057957e+01</td><td>4.198643e-02</td><td>--</td><td>-1.000000e+01</td><td>-3.000000e+01</td><td>0.000000e+00</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5736199120-910386').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5736199120-910386').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---&gt;</span> <span class="n">IC</span>         <span class="n">nu_p</span><span class="o">=+</span><span class="mf">2.550950e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">2.190510e-01</span><span class="p">)</span>  <span class="n">nuFnu_p</span><span class="o">=-</span><span class="mf">1.057957e+01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">4.198643e-02</span><span class="p">)</span> <span class="n">curv</span><span class="o">.=-</span><span class="mf">1.323324e-01</span> <span class="p">(</span><span class="n">err</span><span class="o">=+</span><span class="mf">3.154579e-02</span><span class="p">)</span>
<span class="o">================================================================================</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_16_3.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_16_3.png" />
</section>
<section id="model-constraining">
<h3>Model constraining<a class="headerlink" href="#model-constraining" title="Link to this heading">#</a></h3>
<p>In this step we are not fitting the model, we are just obtaining the
phenomenological <code class="docutils literal notranslate"><span class="pre">pre_fit</span></code> model, that will be fitted in using minuit
ore least-square bound, as shown below</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.obs_constrain</span> <span class="kn">import</span> <span class="n">ObsConstrain</span>
<span class="kn">from</span> <span class="nn">jetset.model_manager</span> <span class="kn">import</span>  <span class="n">FitModel</span>
<span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">fit_SED</span>
<span class="n">sed_obspar</span><span class="o">=</span><span class="n">ObsConstrain</span><span class="p">(</span><span class="n">beaming</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                        <span class="n">B_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span>
                        <span class="n">distr_e</span><span class="o">=</span><span class="s1">&#39;lppl&#39;</span><span class="p">,</span>
                        <span class="n">t_var_sec</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="mi">86400</span><span class="p">,</span>
                        <span class="n">nu_cut_IR</span><span class="o">=</span><span class="mf">1E11</span><span class="p">,</span>
                        <span class="n">SEDShape</span><span class="o">=</span><span class="n">my_shape</span><span class="p">)</span>


<span class="n">prefit_jet</span><span class="o">=</span><span class="n">sed_obspar</span><span class="o">.</span><span class="n">constrain_SSC_model</span><span class="p">(</span><span class="n">electron_distribution_log_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">prefit_jet</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;prefit_jet_gal_templ.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>*  constrains parameters from observable *</strong>

===&gt; setting C threads to 12</pre>
<i>Table length=12</i>
<table id="table5700426032-562712" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>1.141280e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>5.050000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td></td><td>2.500000e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>1.487509e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>2.310708e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>2.312656e+01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>1.107634e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.248426e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>spectral_curvature</td><td></td><td>3.261397e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5700426032-562712').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5700426032-562712').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">=</span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">add_residual_plot</span><span class="p">(</span><span class="n">prefit_jet</span><span class="p">,</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E7</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">1E29</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_20_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_20_0.png" />
</section>
</section>
<section id="model-fitting-procedure">
<h2>Model fitting procedure<a class="headerlink" href="#model-fitting-procedure" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please, read the introduction and the caveat <a class="reference internal" href="../../model_fitting_intro.html#id1"><span class="std std-ref">for the frequentist model fitting</span></a> to understand the frequentist fitting workflow
see the <a class="reference internal" href="../composite_model/Composite_model.html#composite-models"><span class="std std-ref">Composite Models and depending pars</span></a> user guide for further information about the implementation of <a class="reference internal" href="../../../api/jetset.model_manager.FitModel.html#jetset.model_manager.FitModel" title="jetset.model_manager.FitModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FitModel</span></code></a>, in particular for parameter setting</p>
</div>
<section id="model-fitting-with-lsb">
<h3>Model fitting with LSB<a class="headerlink" href="#model-fitting-with-lsb" title="Link to this heading">#</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.model_manager</span> <span class="kn">import</span>  <span class="n">FitModel</span>
<span class="kn">from</span> <span class="nn">jetset.jet_model</span> <span class="kn">import</span> <span class="n">Jet</span>

<span class="n">jet</span><span class="o">=</span><span class="n">Jet</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;prefit_jet_gal_templ.pkl&#39;</span><span class="p">)</span>
<span class="n">jet</span><span class="o">.</span><span class="n">set_gamma_grid_size</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model</span><span class="o">=</span><span class="n">FitModel</span><span class="p">(</span> <span class="n">jet</span><span class="o">=</span><span class="n">jet</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-lsb&#39;</span><span class="p">,</span><span class="n">template</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">host_gal</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
<span class="n">Composite</span> <span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">SSC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">lsb</span>
<span class="nb">type</span><span class="p">:</span> <span class="n">composite_model</span>
<span class="n">components</span> <span class="n">models</span><span class="p">:</span>
 <span class="o">-</span><span class="n">model</span> <span class="n">name</span><span class="p">:</span> <span class="n">jet_leptonic</span> <span class="n">model</span> <span class="nb">type</span><span class="p">:</span> <span class="n">jet</span>
 <span class="o">-</span><span class="n">model</span> <span class="n">name</span><span class="p">:</span> <span class="n">host_galaxy</span> <span class="n">model</span> <span class="nb">type</span><span class="p">:</span> <span class="n">template</span>

<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">individual</span> <span class="n">component</span> <span class="n">description</span>

<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">model</span> <span class="n">description</span><span class="p">:</span>
<span class="o">--------------------------------------------------------------------------------</span>
<span class="nb">type</span><span class="p">:</span> <span class="n">Jet</span>
<span class="n">name</span><span class="p">:</span> <span class="n">jet_leptonic</span>
<span class="n">geometry</span><span class="p">:</span> <span class="n">spherical</span>

<span class="n">electrons</span> <span class="n">distribution</span><span class="p">:</span>
 <span class="nb">type</span><span class="p">:</span> <span class="n">lppl</span>
 <span class="n">gamma</span> <span class="n">energy</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">201</span>
 <span class="n">gmin</span> <span class="n">grid</span> <span class="p">:</span> <span class="mf">1.487509e+02</span>
 <span class="n">gmax</span> <span class="n">grid</span> <span class="p">:</span> <span class="mf">2.310708e+06</span>
 <span class="n">normalization</span><span class="p">:</span>  <span class="kc">True</span>
 <span class="n">log</span><span class="o">-</span><span class="n">values</span><span class="p">:</span>  <span class="kc">False</span>
 <span class="n">ratio</span> <span class="n">of</span> <span class="n">cold</span> <span class="n">protons</span> <span class="n">to</span> <span class="n">relativistic</span> <span class="n">electrons</span><span class="p">:</span> <span class="mf">1.000000e+00</span>

<span class="n">radiative</span> <span class="n">fields</span><span class="p">:</span>
 <span class="n">seed</span> <span class="n">photons</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">100</span>
 <span class="n">IC</span> <span class="n">emission</span> <span class="n">grid</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">100</span>
 <span class="n">source</span> <span class="n">emissivity</span> <span class="n">lower</span> <span class="n">bound</span> <span class="p">:</span>  <span class="mf">1.000000e-120</span>
 <span class="n">spectral</span> <span class="n">components</span><span class="p">:</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sum</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sum</span><span class="p">,</span> <span class="n">hidden</span><span class="p">:</span> <span class="kc">False</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sync</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="bp">self</span><span class="o">-</span><span class="nb">abs</span>
   <span class="n">name</span><span class="p">:</span><span class="n">Sync</span><span class="p">,</span> <span class="n">hidden</span><span class="p">:</span> <span class="kc">False</span>
   <span class="n">name</span><span class="p">:</span><span class="n">SSC</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">on</span>
   <span class="n">name</span><span class="p">:</span><span class="n">SSC</span><span class="p">,</span> <span class="n">hidden</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">external</span> <span class="n">fields</span> <span class="n">transformation</span> <span class="n">method</span><span class="p">:</span> <span class="n">blob</span>

<span class="n">SED</span> <span class="n">info</span><span class="p">:</span>
 <span class="n">nu</span> <span class="n">grid</span> <span class="n">size</span> <span class="n">jetkernel</span><span class="p">:</span> <span class="mi">1000</span>
 <span class="n">nu</span> <span class="n">size</span><span class="p">:</span> <span class="mi">500</span>
 <span class="n">nu</span> <span class="n">mix</span> <span class="p">(</span><span class="n">Hz</span><span class="p">):</span> <span class="mf">1.000000e+06</span>
 <span class="n">nu</span> <span class="nb">max</span> <span class="p">(</span><span class="n">Hz</span><span class="p">):</span> <span class="mf">1.000000e+30</span>

<span class="n">flux</span> <span class="n">plot</span> <span class="n">lower</span> <span class="n">bound</span>   <span class="p">:</span>  <span class="mf">1.000000e-30</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<i>Table length=12</i>
<table id="table5750808368-678149" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>1.487509e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>2.310708e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>2.312656e+01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>1.107634e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.248426e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>spectral_curvature</td><td></td><td>3.261397e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>1.141280e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>5.050000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td></td><td>2.500000e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5750808368-678149').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5750808368-678149').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>

<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">model</span> <span class="n">description</span>
<span class="o">--------------------------------------------------------------------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">host_galaxy</span>
<span class="nb">type</span><span class="p">:</span> <span class="n">template</span>

<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<i>Table length=2</i>
<table id="table5735871824-374274" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>nuFnu-scale</td><td>erg / (s cm2)</td><td>-1.008538e+01</td><td>-2.000000e+01</td><td>2.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>nu-scale</td><td>Hz</td><td>1.934519e-02</td><td>-2.000000e+00</td><td>2.000000e+00</td><td>False</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5735871824-374274').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5735871824-374274').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--------------------------------------------------------------------------------</span>
<span class="o">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the <cite>jet_leptonic to model</cite> has to be summed to the <cite>host_galaxy</cite> model, we do not need to define the functional form for the composite model, because
the default compostion is the sum of all the components
(see the <a class="reference internal" href="../composite_model/Composite_model.html#composite-models"><span class="std std-ref">Composite Models and depending pars</span></a> user guide for further information about the new implementation of <cite>FitModel</cite>, in particular for parameter setting).
Anyhow, we show here the definition of the model composition  for purpose of clarity</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model</span><span class="o">.</span><span class="n">composite_expr</span><span class="o">=</span><span class="s1">&#39;jet_leptonic + host_galaxy&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;z_cosm&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;R_H&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">N</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E-5</span><span class="p">,</span> <span class="mf">1E5</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">B</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E-3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">beam_obj</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E15</span><span class="p">,</span><span class="mf">1E17</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmax</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E4</span><span class="p">,</span><span class="mf">1E8</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">host_galaxy</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">nuFnu_p_host</span><span class="o">.</span><span class="n">frozen</span><span class="o">=</span><span class="kc">False</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">host_galaxy</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">nu_scale</span><span class="o">.</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">fit_SED</span><span class="p">,</span><span class="n">ModelMinimizer</span>

<span class="n">model_minimizer_lsb</span><span class="o">=</span><span class="n">ModelMinimizer</span><span class="p">(</span><span class="s1">&#39;lsb&#39;</span><span class="p">)</span>
<span class="n">best_fit_lsb</span><span class="o">=</span><span class="n">model_minimizer_lsb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_model</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="mf">1E11</span><span class="p">,</span><span class="mf">1E29</span><span class="p">,</span><span class="n">fitname</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-lsb&#39;</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">filtering data in fit range = [1.000000e+11,1.000000e+29]
data length 31
================================================================================

<strong>* start fit process *</strong>
-----</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">4.16923e+01</span>

<span class="o">-------------------------------------------------------------------------</span>
<span class="n">Fit</span> <span class="n">report</span>

<span class="n">Model</span><span class="p">:</span> <span class="n">SSC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">lsb</span>
</pre></div>
</div>
<i>Table length=14</i>
<table id="table5750808368-67023" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>8.580927e+01</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>2.310708e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>5.244887e+01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>1.069947e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.220278e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>spectral_curvature</td><td></td><td>2.813492e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>1.141280e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>3.716188e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td></td><td>2.575826e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>nuFnu-scale</td><td>erg / (s cm2)</td><td>-1.005821e+01</td><td>-2.000000e+01</td><td>2.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>nu-scale</td><td>Hz</td><td>1.934519e-02</td><td>-2.000000e+00</td><td>2.000000e+00</td><td>False</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5750808368-67023').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5750808368-67023').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span><span class="o">=</span><span class="kc">True</span>
<span class="n">calls</span><span class="o">=</span><span class="mi">429</span>
<span class="n">mesg</span><span class="o">=</span>
</pre></div>
</div>
<pre class="literal-block">'<cite>ftol</cite> termination condition is satisfied.'</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span><span class="o">=</span><span class="mi">21</span>
<span class="n">chisq</span><span class="o">=</span><span class="mf">41.692309</span><span class="p">,</span> <span class="n">chisq</span><span class="o">/</span><span class="n">red</span><span class="o">=</span><span class="mf">1.985348</span> <span class="n">null</span> <span class="n">hypothesis</span> <span class="n">sig</span><span class="o">=</span><span class="mf">0.004599</span>

<span class="n">best</span> <span class="n">fit</span> <span class="n">pars</span>
</pre></div>
</div>
<i>Table length=14</i>
<table id="table5736198832-769156" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>8.580927e+01</td><td>8.580927e+01</td><td>2.245405e+02</td><td>--</td><td>1.487509e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>2.310708e+06</td><td>2.310708e+06</td><td>3.063708e+06</td><td>--</td><td>2.310708e+06</td><td>1.000000e+04</td><td>1.000000e+08</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>5.244887e+01</td><td>5.244887e+01</td><td>3.642249e+02</td><td>--</td><td>2.312656e+01</td><td>1.000000e-05</td><td>1.000000e+05</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>1.069947e+04</td><td>1.069947e+04</td><td>1.593138e+04</td><td>--</td><td>1.107634e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>2.220278e+00</td><td>2.220278e+00</td><td>6.119317e-02</td><td>--</td><td>2.248426e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>2.813492e-01</td><td>2.813492e-01</td><td>6.199616e-02</td><td>--</td><td>3.261397e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>1.141280e+16</td><td>1.141280e+16</td><td>4.323108e+16</td><td>--</td><td>1.141280e+16</td><td>1.000000e+15</td><td>1.000000e+17</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>1.000000e+17</td><td>--</td><td>--</td><td>--</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>3.716188e-02</td><td>3.716188e-02</td><td>4.850783e-02</td><td>--</td><td>5.050000e-02</td><td>1.000000e-03</td><td>1.000000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>1.000000e+00</td><td>--</td><td>--</td><td>--</td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>2.575826e+01</td><td>2.575826e+01</td><td>3.748732e+01</td><td>--</td><td>2.500000e+01</td><td>5.000000e+00</td><td>5.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>3.360000e-02</td><td>--</td><td>--</td><td>--</td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>-1.005821e+01</td><td>-1.005821e+01</td><td>3.476096e-02</td><td>--</td><td>-1.008538e+01</td><td>-1.222242e+01</td><td>-8.222416e+00</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>1.934519e-02</td><td>--</td><td>--</td><td>--</td><td>1.934519e-02</td><td>-5.000000e-01</td><td>5.000000e-01</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5736198832-769156').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5736198832-769156').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-------------------------------------------------------------------------</span>

<span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_fit_lsb</span><span class="o">.</span><span class="n">save_report</span><span class="p">(</span><span class="s1">&#39;SSC-best-fit-lsb.pkl&#39;</span><span class="p">)</span>
<span class="n">model_minimizer_lsb</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;model_minimizer_lsb.pkl&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;fit_model_lsb.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fit_model</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p2</span><span class="o">=</span><span class="n">fit_model</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_31_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_31_0.png" />
</section>
<section id="model-fitting-with-minuit">
<h3>Model fitting with Minuit<a class="headerlink" href="#model-fitting-with-minuit" title="Link to this heading">#</a></h3>
<p>To run the <code class="docutils literal notranslate"><span class="pre">minuit</span></code> minimizer we will use the best-fit results from
<code class="docutils literal notranslate"><span class="pre">lsb</span></code> to set the boundaries for our parameters.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;z_cosm&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;R_H&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">beam_obj</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="o">**</span><span class="mf">15.5</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mf">17.5</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">host_galaxy</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">nuFnu_p_host</span><span class="o">.</span><span class="n">frozen</span><span class="o">=</span><span class="kc">False</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">host_galaxy</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">nu_scale</span><span class="o">.</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmin</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmax</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">5E5</span><span class="p">,</span><span class="mf">1E8</span><span class="p">]</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gamma0_log_parab</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E3</span><span class="p">,</span><span class="mf">5E5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_minimizer_minuit</span><span class="o">=</span><span class="n">ModelMinimizer</span><span class="p">(</span><span class="s1">&#39;minuit&#39;</span><span class="p">)</span>
<span class="n">best_fit_minuit</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_model</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="mf">1E11</span><span class="p">,</span><span class="mf">1E29</span><span class="p">,</span><span class="n">fitname</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-minuit&#39;</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">filtering data in fit range = [1.000000e+11,1.000000e+29]
data length 31
================================================================================

<strong>* start fit process *</strong>
-----
fit run: 0</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====&gt;</span> <span class="n">simplex</span>
<span class="o">====&gt;</span> <span class="n">migrad</span>
<span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.04513e+01</span>

<span class="n">fit</span> <span class="n">run</span><span class="p">:</span> <span class="mi">1</span>
<span class="o">-</span> <span class="n">old</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.04513e+01</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====&gt;</span> <span class="n">simplex</span>
<span class="o">====&gt;</span> <span class="n">migrad</span>
<span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.04509e+01</span>

<span class="n">fit</span> <span class="n">run</span><span class="p">:</span> <span class="mi">2</span>
<span class="o">-</span> <span class="n">old</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.04509e+01</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====&gt;</span> <span class="n">simplex</span>
<span class="o">====&gt;</span> <span class="n">migrad</span>
<span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.04509e+01</span>

<span class="o">-------------------------------------------------------------------------</span>
<span class="n">Fit</span> <span class="n">report</span>

<span class="n">Model</span><span class="p">:</span> <span class="n">SSC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">minuit</span>
</pre></div>
</div>
<i>Table length=14</i>
<table id="table5754969760-923841" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>5.455560e+01</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>2.105148e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>4.504764e+01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>5.386110e+03</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>LE_spectral_slope</td><td></td><td>2.168634e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>spectral_curvature</td><td></td><td>2.323139e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>1.298307e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>1.206137e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td></td><td>4.763830e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>nuFnu-scale</td><td>erg / (s cm2)</td><td>-1.008451e+01</td><td>-2.000000e+01</td><td>2.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>nu-scale</td><td>Hz</td><td>1.934519e-02</td><td>-2.000000e+00</td><td>2.000000e+00</td><td>False</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5754969760-923841').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5754969760-923841').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span><span class="o">=</span><span class="kc">True</span>
<span class="n">calls</span><span class="o">=</span><span class="mi">1019</span>
<span class="n">mesg</span><span class="o">=</span>
</pre></div>
</div>
<table>
    <tr>
        <th colspan="5" style="text-align:center" title="Minimizer"> Migrad </th>
    </tr>
    <tr>
        <td colspan="2" style="text-align:left" title="Minimum value of function"> FCN = 10.45 </td>
        <td colspan="3" style="text-align:center" title="Total number of function and (optional) gradient evaluations"> Nfcn = 1019 </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:left" title="Estimated distance to minimum and goal"> EDM = 1.19e-05 (Goal: 0.0002) </td>
        <td colspan="3" style="text-align:center" title="Total run time of algorithms"> time = 27.0 sec </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:center;background-color:#92CCA6;color:black"> Valid Minimum </td>
        <td colspan="3" style="text-align:center;background-color:#92CCA6;color:black"> No Parameters at limit </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:center;background-color:#92CCA6;color:black"> Below EDM threshold (goal x 10) </td>
        <td colspan="3" style="text-align:center;background-color:#92CCA6;color:black"> Below call limit </td>
    </tr>
    <tr>
        <td style="text-align:center;background-color:#92CCA6;color:black"> Covariance </td>
        <td style="text-align:center;background-color:#92CCA6;color:black"> Hesse ok </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Is covariance matrix accurate?"> Accurate </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Is covariance matrix positive definite?"> Pos. def. </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Was positive definiteness enforced by Minuit?"> Not forced </td>
    </tr>
</table><table>
    <tr>
        <td></td>
        <th title="Variable name"> Name </th>
        <th title="Value of parameter"> Value </th>
        <th title="Hesse error"> Hesse Error </th>
        <th title="Minos lower error"> Minos Error- </th>
        <th title="Minos upper error"> Minos Error+ </th>
        <th title="Lower limit of the parameter"> Limit- </th>
        <th title="Upper limit of the parameter"> Limit+ </th>
        <th title="Is the parameter fixed in the fit"> Fixed </th>
    </tr>
    <tr>
        <th> 0 </th>
        <td> par_0 </td>
        <td> 54.56 </td>
        <td> 0.27 </td>
        <td>  </td>
        <td>  </td>
        <td> 10 </td>
        <td> 1E+03 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 1 </th>
        <td> par_1 </td>
        <td> 2.11e6 </td>
        <td> 0.17e6 </td>
        <td>  </td>
        <td>  </td>
        <td> 5E+05 </td>
        <td> 1E+08 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 2 </th>
        <td> par_2 </td>
        <td> 45.0 </td>
        <td> 0.4 </td>
        <td>  </td>
        <td>  </td>
        <td> 1E-05 </td>
        <td> 1E+05 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 3 </th>
        <td> par_3 </td>
        <td> 5.39e3 </td>
        <td> 0.08e3 </td>
        <td>  </td>
        <td>  </td>
        <td> 1E+03 </td>
        <td> 5E+05 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 4 </th>
        <td> par_4 </td>
        <td> 2.169 </td>
        <td> 0.004 </td>
        <td>  </td>
        <td>  </td>
        <td> -10 </td>
        <td> 10 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 5 </th>
        <td> par_5 </td>
        <td> 232.3e-3 </td>
        <td> 0.8e-3 </td>
        <td>  </td>
        <td>  </td>
        <td> -15 </td>
        <td> 15 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 6 </th>
        <td> par_6 </td>
        <td> 12.983e15 </td>
        <td> 0.033e15 </td>
        <td>  </td>
        <td>  </td>
        <td> 3.16E+15 </td>
        <td> 3.16E+17 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 7 </th>
        <td> par_7 </td>
        <td> 12.06e-3 </td>
        <td> 0.09e-3 </td>
        <td>  </td>
        <td>  </td>
        <td> 0.001 </td>
        <td> 1 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 8 </th>
        <td> par_8 </td>
        <td> 47.64 </td>
        <td> 0.17 </td>
        <td>  </td>
        <td>  </td>
        <td> 5 </td>
        <td> 50 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 9 </th>
        <td> par_9 </td>
        <td> -10.085 </td>
        <td> 0.020 </td>
        <td>  </td>
        <td>  </td>
        <td> -12.2 </td>
        <td> -8.22 </td>
        <td>  </td>
    </tr>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span><span class="o">=</span><span class="mi">21</span>
<span class="n">chisq</span><span class="o">=</span><span class="mf">10.450851</span><span class="p">,</span> <span class="n">chisq</span><span class="o">/</span><span class="n">red</span><span class="o">=</span><span class="mf">0.497660</span> <span class="n">null</span> <span class="n">hypothesis</span> <span class="n">sig</span><span class="o">=</span><span class="mf">0.972444</span>

<span class="n">best</span> <span class="n">fit</span> <span class="n">pars</span>
</pre></div>
</div>
<i>Table length=14</i>
<table id="table5754962608-994070" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>5.455560e+01</td><td>5.455560e+01</td><td>2.726560e-01</td><td>--</td><td>8.580927e+01</td><td>1.000000e+01</td><td>1.000000e+03</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>2.105148e+06</td><td>2.105148e+06</td><td>1.675281e+05</td><td>--</td><td>2.310708e+06</td><td>5.000000e+05</td><td>1.000000e+08</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>4.504764e+01</td><td>4.504764e+01</td><td>4.131515e-01</td><td>--</td><td>5.244887e+01</td><td>1.000000e-05</td><td>1.000000e+05</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma0_log_parab</td><td>5.386110e+03</td><td>5.386110e+03</td><td>7.892077e+01</td><td>--</td><td>1.069947e+04</td><td>1.000000e+03</td><td>5.000000e+05</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>s</td><td>2.168634e+00</td><td>2.168634e+00</td><td>3.851834e-03</td><td>--</td><td>2.220278e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>r</td><td>2.323139e-01</td><td>2.323139e-01</td><td>7.857833e-04</td><td>--</td><td>2.813492e-01</td><td>-1.500000e+01</td><td>1.500000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>1.298307e+16</td><td>1.298307e+16</td><td>3.259461e+13</td><td>--</td><td>1.141280e+16</td><td>3.162278e+15</td><td>3.162278e+17</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>1.000000e+17</td><td>--</td><td>--</td><td>--</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>1.206137e-02</td><td>1.206137e-02</td><td>8.551352e-05</td><td>--</td><td>3.716188e-02</td><td>1.000000e-03</td><td>1.000000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>1.000000e+00</td><td>--</td><td>--</td><td>--</td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>4.763830e+01</td><td>4.763830e+01</td><td>1.659000e-01</td><td>--</td><td>2.575826e+01</td><td>5.000000e+00</td><td>5.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>3.360000e-02</td><td>--</td><td>--</td><td>--</td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>-1.008451e+01</td><td>-1.008451e+01</td><td>1.998494e-02</td><td>--</td><td>-1.005821e+01</td><td>-1.222242e+01</td><td>-8.222416e+00</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>1.934519e-02</td><td>--</td><td>--</td><td>--</td><td>1.934519e-02</td><td>-5.000000e-01</td><td>5.000000e-01</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5754962608-994070').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5754962608-994070').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-------------------------------------------------------------------------</span>

<span class="o">================================================================================</span>
</pre></div>
</div>
<p>for further information regardin minuit please refer to
<a class="reference external" href="https://iminuit.readthedocs.io/en/stable/">https://iminuit.readthedocs.io/en/stable/</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fit_model</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p2</span><span class="o">=</span><span class="n">fit_model</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_37_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_37_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_fit_minuit</span><span class="o">.</span><span class="n">save_report</span><span class="p">(</span><span class="s1">&#39;SSC-best-fit-minuit.pkl&#39;</span><span class="p">)</span>
<span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;model_minimizer_minuit.pkl&#39;</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;fit_model_minuit.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="model-fitting-with-a-bkn-pl">
<h3>Model fitting with a bkn pl<a class="headerlink" href="#model-fitting-with-a-bkn-pl" title="Link to this heading">#</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.obs_constrain</span> <span class="kn">import</span> <span class="n">ObsConstrain</span>
<span class="kn">from</span> <span class="nn">jetset.model_manager</span> <span class="kn">import</span>  <span class="n">FitModel</span>
<span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">fit_SED</span>
<span class="n">sed_obspar</span><span class="o">=</span><span class="n">ObsConstrain</span><span class="p">(</span><span class="n">beaming</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                        <span class="n">B_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span>
                        <span class="n">distr_e</span><span class="o">=</span><span class="s1">&#39;bkn&#39;</span><span class="p">,</span>
                        <span class="n">t_var_sec</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="mi">86400</span><span class="p">,</span>
                        <span class="n">nu_cut_IR</span><span class="o">=</span><span class="mf">1E11</span><span class="p">,</span>
                        <span class="n">SEDShape</span><span class="o">=</span><span class="n">my_shape</span><span class="p">)</span>


<span class="n">prefit_jet</span><span class="o">=</span><span class="n">sed_obspar</span><span class="o">.</span><span class="n">constrain_SSC_model</span><span class="p">(</span><span class="n">electron_distribution_log_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">prefit_jet</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span><span class="s1">&#39;prefit_jet_bkn_gal_templ.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">================================================================================

<strong>*  constrains parameters from observable *</strong>

===&gt; setting C threads to 12</pre>
<i>Table length=12</i>
<table id="table5754377248-980135" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>1.247372e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>2.847716e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td></td><td>2.500000e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>1.980875e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>3.077106e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>1.406682e+01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>2.094216e+05</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>LE_spectral_slope</td><td></td><td>2.248426e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>3.500000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5754377248-980135').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5754377248-980135').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">=</span><span class="n">prefit_jet</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">add_residual_plot</span><span class="p">(</span><span class="n">prefit_jet</span><span class="p">,</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E7</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">1E29</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_41_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_41_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jet_minuit_bkn</span><span class="o">=</span><span class="n">Jet</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;prefit_jet_bkn_gal_templ.pkl&#39;</span><span class="p">)</span>
<span class="n">jet_minuit_bkn</span><span class="o">.</span><span class="n">set_gamma_grid_size</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>

<span class="n">fit_model_bkn</span><span class="o">=</span><span class="n">FitModel</span><span class="p">(</span> <span class="n">jet</span><span class="o">=</span><span class="n">jet_minuit_bkn</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-bkn-lsb&#39;</span><span class="p">,</span><span class="n">template</span><span class="o">=</span><span class="n">my_shape</span><span class="o">.</span><span class="n">host_gal</span><span class="p">)</span>


<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;z_cosm&#39;</span><span class="p">)</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">freeze</span><span class="p">(</span><span class="s1">&#39;jet_leptonic&#39;</span><span class="p">,</span><span class="s1">&#39;R_H&#39;</span><span class="p">)</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">beam_obj</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="o">**</span><span class="mf">15.5</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mf">17.5</span><span class="p">]</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmax</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E4</span><span class="p">,</span><span class="mf">1E8</span><span class="p">]</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">host_galaxy</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">nuFnu_p_host</span><span class="o">.</span><span class="n">frozen</span><span class="o">=</span><span class="kc">False</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">host_galaxy</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">nu_scale</span><span class="o">.</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_minimizer_lsb_bkn</span><span class="o">=</span><span class="n">ModelMinimizer</span><span class="p">(</span><span class="s1">&#39;lsb&#39;</span><span class="p">)</span>
<span class="n">best_fit_lsb_bkn</span><span class="o">=</span><span class="n">model_minimizer_lsb_bkn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_model_bkn</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="mf">1E11</span><span class="p">,</span><span class="mf">1E29</span><span class="p">,</span><span class="n">fitname</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-lsb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">filtering data in fit range = [1.000000e+11,1.000000e+29]
data length 31
================================================================================

<strong>* start fit process *</strong>
-----</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">2.49214e+01</span>

<span class="o">-------------------------------------------------------------------------</span>
<span class="n">Fit</span> <span class="n">report</span>

<span class="n">Model</span><span class="p">:</span> <span class="n">SSC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">lsb</span>
</pre></div>
</div>
<i>Table length=14</i>
<table id="table5761882560-627946" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>1.485242e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>3.071765e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>1.629672e+01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>8.193745e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>LE_spectral_slope</td><td></td><td>2.262508e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>3.169331e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>1.247372e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>1.430585e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td></td><td>4.463828e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>nuFnu-scale</td><td>erg / (s cm2)</td><td>-1.006917e+01</td><td>-2.000000e+01</td><td>2.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>nu-scale</td><td>Hz</td><td>1.934519e-02</td><td>-2.000000e+00</td><td>2.000000e+00</td><td>False</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5761882560-627946').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5761882560-627946').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span><span class="o">=</span><span class="kc">True</span>
<span class="n">calls</span><span class="o">=</span><span class="mi">482</span>
<span class="n">mesg</span><span class="o">=</span>
</pre></div>
</div>
<pre class="literal-block">'<cite>ftol</cite> termination condition is satisfied.'</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span><span class="o">=</span><span class="mi">21</span>
<span class="n">chisq</span><span class="o">=</span><span class="mf">24.921362</span><span class="p">,</span> <span class="n">chisq</span><span class="o">/</span><span class="n">red</span><span class="o">=</span><span class="mf">1.186732</span> <span class="n">null</span> <span class="n">hypothesis</span> <span class="n">sig</span><span class="o">=</span><span class="mf">0.250586</span>

<span class="n">best</span> <span class="n">fit</span> <span class="n">pars</span>
</pre></div>
</div>
<i>Table length=14</i>
<table id="table5761634880-560519" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>1.485242e+02</td><td>1.485242e+02</td><td>1.195436e+02</td><td>--</td><td>1.980875e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>3.071765e+06</td><td>3.071765e+06</td><td>1.921033e+06</td><td>--</td><td>3.077106e+06</td><td>1.000000e+04</td><td>1.000000e+08</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>1.629672e+01</td><td>1.629672e+01</td><td>2.985576e+01</td><td>--</td><td>1.406682e+01</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>8.193745e+04</td><td>8.193745e+04</td><td>5.261749e+04</td><td>--</td><td>2.094216e+05</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>2.262508e+00</td><td>2.262508e+00</td><td>3.933694e-02</td><td>--</td><td>2.248426e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>3.169331e+00</td><td>3.169331e+00</td><td>4.793906e-02</td><td>--</td><td>3.500000e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>1.247372e+16</td><td>1.247372e+16</td><td>2.236984e+16</td><td>--</td><td>1.247372e+16</td><td>3.162278e+15</td><td>3.162278e+17</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>1.000000e+17</td><td>--</td><td>--</td><td>--</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>1.430585e-02</td><td>1.430585e-02</td><td>1.084428e-02</td><td>--</td><td>2.847716e-02</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>1.000000e+00</td><td>--</td><td>--</td><td>--</td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>4.463828e+01</td><td>4.463828e+01</td><td>2.806607e+01</td><td>--</td><td>2.500000e+01</td><td>5.000000e+00</td><td>5.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>3.360000e-02</td><td>--</td><td>--</td><td>--</td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>-1.006917e+01</td><td>-1.006917e+01</td><td>2.666541e-02</td><td>--</td><td>-1.008451e+01</td><td>-1.222242e+01</td><td>-8.222416e+00</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>1.934519e-02</td><td>--</td><td>--</td><td>--</td><td>1.934519e-02</td><td>-5.000000e-01</td><td>5.000000e-01</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5761634880-560519').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5761634880-560519').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-------------------------------------------------------------------------</span>

<span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p2</span><span class="o">=</span><span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_44_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_44_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">beam_obj</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="o">**</span><span class="mf">15.5</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mf">17.5</span><span class="p">]</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">host_galaxy</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">nuFnu_p_host</span><span class="o">.</span><span class="n">frozen</span><span class="o">=</span><span class="kc">False</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">host_galaxy</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">nu_scale</span><span class="o">.</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmin</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">]</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gmax</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">5E5</span><span class="p">,</span><span class="mf">1E8</span><span class="p">]</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">gamma_break</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E3</span><span class="p">,</span><span class="mf">1E6</span><span class="p">]</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">p_1</span><span class="o">.</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>


<span class="n">model_minimizer_minuit_bkn</span><span class="o">=</span><span class="n">ModelMinimizer</span><span class="p">(</span><span class="s1">&#39;minuit&#39;</span><span class="p">)</span>
<span class="n">best_fit_minuit_bkn</span><span class="o">=</span><span class="n">model_minimizer_minuit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fit_model_bkn</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="mf">1E11</span><span class="p">,</span><span class="mf">1E29</span><span class="p">,</span><span class="n">fitname</span><span class="o">=</span><span class="s1">&#39;SSC-best-fit-minuit-bkn&#39;</span><span class="p">,</span><span class="n">repeat</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">filtering data in fit range = [1.000000e+11,1.000000e+29]
data length 31
================================================================================

<strong>* start fit process *</strong>
-----
fit run: 0</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====&gt;</span> <span class="n">simplex</span>
<span class="o">====&gt;</span> <span class="n">migrad</span>
<span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.34228e+01</span>

<span class="n">fit</span> <span class="n">run</span><span class="p">:</span> <span class="mi">1</span>
<span class="o">-</span> <span class="n">old</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.34228e+01</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====&gt;</span> <span class="n">simplex</span>
<span class="o">====&gt;</span> <span class="n">migrad</span>
<span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.30362e+01</span>

<span class="n">fit</span> <span class="n">run</span><span class="p">:</span> <span class="mi">2</span>
<span class="o">-</span> <span class="n">old</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.30362e+01</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0it [00:00, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====&gt;</span> <span class="n">simplex</span>
<span class="o">====&gt;</span> <span class="n">migrad</span>
<span class="o">-</span> <span class="n">best</span> <span class="n">chisq</span><span class="o">=</span><span class="mf">1.30275e+01</span>

<span class="o">-------------------------------------------------------------------------</span>
<span class="n">Fit</span> <span class="n">report</span>

<span class="n">Model</span><span class="p">:</span> <span class="n">SSC</span><span class="o">-</span><span class="n">best</span><span class="o">-</span><span class="n">fit</span><span class="o">-</span><span class="n">minuit</span><span class="o">-</span><span class="n">bkn</span>
</pre></div>
</div>
<i>Table length=14</i>
<table id="table5756151760-382590" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>par type</th><th>units</th><th>val</th><th>phys. bound. min</th><th>phys. bound. max</th><th>log</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>low-energy-cut-off</td><td>lorentz-factor*</td><td>1.345014e+02</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>high-energy-cut-off</td><td>lorentz-factor*</td><td>1.773731e+06</td><td>1.000000e+00</td><td>1.000000e+15</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>emitters_density</td><td>1 / cm3</td><td>1.625170e+01</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>turn-over-energy</td><td>lorentz-factor*</td><td>5.531173e+04</td><td>1.000000e+00</td><td>1.000000e+09</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>LE_spectral_slope</td><td></td><td>2.248959e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>HE_spectral_slope</td><td></td><td>2.952674e+00</td><td>-1.000000e+01</td><td>1.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>region_size</td><td>cm</td><td>1.464854e+16</td><td>1.000000e+03</td><td>1.000000e+30</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>region_position</td><td>cm</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>magnetic_field</td><td>gauss</td><td>1.349383e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>cold_p_to_rel_e_ratio</td><td></td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>beaming</td><td></td><td>4.128886e+01</td><td>1.000000e-04</td><td>--</td><td>False</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>redshift</td><td></td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>False</td><td>True</td></tr>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>nuFnu-scale</td><td>erg / (s cm2)</td><td>-1.007170e+01</td><td>-2.000000e+01</td><td>2.000000e+01</td><td>False</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>nu-scale</td><td>Hz</td><td>1.934519e-02</td><td>-2.000000e+00</td><td>2.000000e+00</td><td>False</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5756151760-382590').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5756151760-382590').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [4, 5, 6], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">converged</span><span class="o">=</span><span class="kc">True</span>
<span class="n">calls</span><span class="o">=</span><span class="mi">1353</span>
<span class="n">mesg</span><span class="o">=</span>
</pre></div>
</div>
<table>
    <tr>
        <th colspan="5" style="text-align:center" title="Minimizer"> Migrad </th>
    </tr>
    <tr>
        <td colspan="2" style="text-align:left" title="Minimum value of function"> FCN = 13.03 </td>
        <td colspan="3" style="text-align:center" title="Total number of function and (optional) gradient evaluations"> Nfcn = 1353 </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:left" title="Estimated distance to minimum and goal"> EDM = 5.33e-06 (Goal: 0.0002) </td>
        <td colspan="3" style="text-align:center" title="Total run time of algorithms"> time = 27.0 sec </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:center;background-color:#92CCA6;color:black"> Valid Minimum </td>
        <td colspan="3" style="text-align:center;background-color:#92CCA6;color:black"> No Parameters at limit </td>
    </tr>
    <tr>
        <td colspan="2" style="text-align:center;background-color:#92CCA6;color:black"> Below EDM threshold (goal x 10) </td>
        <td colspan="3" style="text-align:center;background-color:#92CCA6;color:black"> Below call limit </td>
    </tr>
    <tr>
        <td style="text-align:center;background-color:#92CCA6;color:black"> Covariance </td>
        <td style="text-align:center;background-color:#92CCA6;color:black"> Hesse ok </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Is covariance matrix accurate?"> Accurate </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Is covariance matrix positive definite?"> Pos. def. </td>
        <td style="text-align:center;background-color:#92CCA6;color:black" title="Was positive definiteness enforced by Minuit?"> Not forced </td>
    </tr>
</table><table>
    <tr>
        <td></td>
        <th title="Variable name"> Name </th>
        <th title="Value of parameter"> Value </th>
        <th title="Hesse error"> Hesse Error </th>
        <th title="Minos lower error"> Minos Error- </th>
        <th title="Minos upper error"> Minos Error+ </th>
        <th title="Lower limit of the parameter"> Limit- </th>
        <th title="Upper limit of the parameter"> Limit+ </th>
        <th title="Is the parameter fixed in the fit"> Fixed </th>
    </tr>
    <tr>
        <th> 0 </th>
        <td> par_0 </td>
        <td> 134.501 </td>
        <td> 0.019 </td>
        <td>  </td>
        <td>  </td>
        <td> 10 </td>
        <td> 1E+03 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 1 </th>
        <td> par_1 </td>
        <td> 1.7737e6 </td>
        <td> 0.0011e6 </td>
        <td>  </td>
        <td>  </td>
        <td> 5E+05 </td>
        <td> 1E+08 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 2 </th>
        <td> par_2 </td>
        <td> 16.2517 </td>
        <td> 0.0009 </td>
        <td>  </td>
        <td>  </td>
        <td> 0 </td>
        <td>  </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 3 </th>
        <td> par_3 </td>
        <td> 55.312e3 </td>
        <td> 0.032e3 </td>
        <td>  </td>
        <td>  </td>
        <td> 1E+03 </td>
        <td> 1E+06 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 4 </th>
        <td> par_4 </td>
        <td> 2.248959 </td>
        <td> 0.000020 </td>
        <td>  </td>
        <td>  </td>
        <td> 1 </td>
        <td> 3 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 5 </th>
        <td> par_5 </td>
        <td> 2.95267 </td>
        <td> 0.00015 </td>
        <td>  </td>
        <td>  </td>
        <td> 2 </td>
        <td> 5 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 6 </th>
        <td> par_6 </td>
        <td> 14.65e15 </td>
        <td> 0.05e15 </td>
        <td>  </td>
        <td>  </td>
        <td> 3.16E+15 </td>
        <td> 3.16E+17 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 7 </th>
        <td> par_7 </td>
        <td> 13.494e-3 </td>
        <td> 0.010e-3 </td>
        <td>  </td>
        <td>  </td>
        <td> 0 </td>
        <td>  </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 8 </th>
        <td> par_8 </td>
        <td> 41.29 </td>
        <td> 0.11 </td>
        <td>  </td>
        <td>  </td>
        <td> 5 </td>
        <td> 50 </td>
        <td>  </td>
    </tr>
    <tr>
        <th> 9 </th>
        <td> par_9 </td>
        <td> -10.072 </td>
        <td> 0.015 </td>
        <td>  </td>
        <td>  </td>
        <td> -12.2 </td>
        <td> -8.22 </td>
        <td>  </td>
    </tr>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dof</span><span class="o">=</span><span class="mi">21</span>
<span class="n">chisq</span><span class="o">=</span><span class="mf">13.027500</span><span class="p">,</span> <span class="n">chisq</span><span class="o">/</span><span class="n">red</span><span class="o">=</span><span class="mf">0.620357</span> <span class="n">null</span> <span class="n">hypothesis</span> <span class="n">sig</span><span class="o">=</span><span class="mf">0.907658</span>

<span class="n">best</span> <span class="n">fit</span> <span class="n">pars</span>
</pre></div>
</div>
<i>Table length=14</i>
<table id="table5756087232-84042" class="table-striped table-bordered table-condensed">
<thead><tr><th>model name</th><th>name</th><th>val</th><th>bestfit val</th><th>err +</th><th>err -</th><th>start val</th><th>fit range min</th><th>fit range max</th><th>frozen</th></tr></thead>
<tr><td>jet_leptonic</td><td>gmin</td><td>1.345014e+02</td><td>1.345014e+02</td><td>1.935667e-02</td><td>--</td><td>1.485242e+02</td><td>1.000000e+01</td><td>1.000000e+03</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gmax</td><td>1.773731e+06</td><td>1.773731e+06</td><td>1.129851e+03</td><td>--</td><td>3.071765e+06</td><td>5.000000e+05</td><td>1.000000e+08</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>N</td><td>1.625170e+01</td><td>1.625170e+01</td><td>8.522217e-04</td><td>--</td><td>1.629672e+01</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>gamma_break</td><td>5.531173e+04</td><td>5.531173e+04</td><td>3.220423e+01</td><td>--</td><td>8.193745e+04</td><td>1.000000e+03</td><td>1.000000e+06</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p</td><td>2.248959e+00</td><td>2.248959e+00</td><td>2.045150e-05</td><td>--</td><td>2.262508e+00</td><td>1.000000e+00</td><td>3.000000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>p_1</td><td>2.952674e+00</td><td>2.952674e+00</td><td>1.524221e-04</td><td>--</td><td>3.169331e+00</td><td>2.000000e+00</td><td>5.000000e+00</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R</td><td>1.464854e+16</td><td>1.464854e+16</td><td>5.023364e+13</td><td>--</td><td>1.247372e+16</td><td>3.162278e+15</td><td>3.162278e+17</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>R_H</td><td>1.000000e+17</td><td>--</td><td>--</td><td>--</td><td>1.000000e+17</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>B</td><td>1.349383e-02</td><td>1.349383e-02</td><td>1.023312e-05</td><td>--</td><td>1.430585e-02</td><td>0.000000e+00</td><td>--</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>NH_cold_to_rel_e</td><td>1.000000e+00</td><td>--</td><td>--</td><td>--</td><td>1.000000e+00</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>jet_leptonic</td><td>beam_obj</td><td>4.128886e+01</td><td>4.128886e+01</td><td>1.130872e-01</td><td>--</td><td>4.463828e+01</td><td>5.000000e+00</td><td>5.000000e+01</td><td>False</td></tr>
<tr><td>jet_leptonic</td><td>z_cosm</td><td>3.360000e-02</td><td>--</td><td>--</td><td>--</td><td>3.360000e-02</td><td>0.000000e+00</td><td>--</td><td>True</td></tr>
<tr><td>host_galaxy</td><td>nuFnu_p_host</td><td>-1.007170e+01</td><td>-1.007170e+01</td><td>1.541061e-02</td><td>--</td><td>-1.006917e+01</td><td>-1.222242e+01</td><td>-8.222416e+00</td><td>False</td></tr>
<tr><td>host_galaxy</td><td>nu_scale</td><td>1.934519e-02</td><td>--</td><td>--</td><td>--</td><td>1.934519e-02</td><td>-5.000000e-01</td><td>5.000000e-01</td><td>True</td></tr>
</table><style>table.dataTable {clear: both; width: auto !important; margin: 0 !important;}
.dataTables_info, .dataTables_length, .dataTables_filter, .dataTables_paginate{
display: inline-block; margin-right: 1em; }
.paginate_button { margin-right: 5px; }
</style>
<script>

var astropy_sort_num = function(a, b) {
    var a_num = parseFloat(a);
    var b_num = parseFloat(b);

    if (isNaN(a_num) && isNaN(b_num))
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    else if (!isNaN(a_num) && !isNaN(b_num))
        return ((a_num < b_num) ? -1 : ((a_num > b_num) ? 1 : 0));
    else
        return isNaN(a_num) ? -1 : 1;
}

require.config({paths: {
    datatables: 'https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min'
}});
require(["datatables"], function(){
    console.log("$('#table5756087232-84042').dataTable()");

jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "optionalnum-asc": astropy_sort_num,
    "optionalnum-desc": function (a,b) { return -astropy_sort_num(a, b); }
});

    $('#table5756087232-84042').dataTable({
        order: [],
        pageLength: 100,
        lengthMenu: [[10, 25, 50, 100, 500, 1000, -1], [10, 25, 50, 100, 500, 1000, 'All']],
        pagingType: "full_numbers",
        columnDefs: [{targets: [2, 3, 4, 5, 6, 7, 8], type: "optionalnum"}]
    });
});
</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-------------------------------------------------------------------------</span>

<span class="o">================================================================================</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">p2</span><span class="o">=</span><span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_46_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_46_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">jetset.plot_sedfit</span> <span class="kn">import</span> <span class="n">PlotSED</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fit_model_bkn</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">set_nu_grid</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span><span class="mf">1E30</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">fit_model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="n">p2</span><span class="o">=</span><span class="n">PlotSED</span><span class="p">()</span>
<span class="n">p2</span><span class="o">.</span><span class="n">add_data_plot</span><span class="p">(</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span> <span class="mf">1E11</span><span class="p">,</span> <span class="mf">1E29</span><span class="p">])</span>
<span class="n">p2</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">fit_model</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">add_residual_plot</span><span class="p">(</span><span class="n">fit_model</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span> <span class="mf">1E11</span><span class="p">,</span> <span class="mf">1E29</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">add_model_plot</span><span class="p">(</span><span class="n">fit_model_bkn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">add_residual_plot</span><span class="p">(</span><span class="n">fit_model_bkn</span><span class="p">,</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span> <span class="mf">1E11</span><span class="p">,</span> <span class="mf">1E29</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">p2</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_47_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_47_0.png" />
</section>
</section>
<section id="mcmc-sampling">
<h2>MCMC sampling<a class="headerlink" href="#mcmc-sampling" title="Link to this heading">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please, read the introduction and the caveat <a class="reference internal" href="../../model_fitting_intro.html#bayesian-model-fitting"><span class="std std-ref">for the Bayesian model fitting</span></a> to understand the MCMC sampler workflow.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.mcmc</span> <span class="kn">import</span> <span class="n">McmcSampler</span>
<span class="kn">from</span> <span class="nn">jetset.minimizer</span> <span class="kn">import</span> <span class="n">ModelMinimizer</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_minimizer_lsb</span> <span class="o">=</span> <span class="n">ModelMinimizer</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;model_minimizer_minuit.pkl&#39;</span><span class="p">)</span>

<span class="n">mcmc</span><span class="o">=</span><span class="n">McmcSampler</span><span class="p">(</span><span class="n">model_minimizer_lsb</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;gamma0_log_parab&#39;</span><span class="p">]</span>
<span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;jet_leptonic&#39;</span>
<span class="n">use_labels_dict</span><span class="o">=</span><span class="p">{</span><span class="n">model_name</span><span class="p">:</span><span class="n">labels</span><span class="p">}</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_labels</span><span class="p">(</span><span class="n">use_labels_dict</span><span class="o">=</span><span class="n">use_labels_dict</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">bound_rel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">par</span><span class="p">:</span> <span class="n">N</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">45.0476406721727</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-05</span><span class="p">,</span> <span class="mf">270.2858440330362</span><span class="p">]</span>
<span class="n">par</span><span class="p">:</span> <span class="n">B</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">0.012061365634053165</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.07236819380431898</span><span class="p">]</span>
<span class="n">par</span><span class="p">:</span> <span class="n">beam_obj</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">47.638299687949946</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">]</span>
<span class="n">par</span><span class="p">:</span> <span class="n">s</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">2.1686339157854624</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">8.67453566314185</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">par</span><span class="p">:</span> <span class="n">gamma0_log_parab</span>  <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span><span class="p">:</span>  <span class="mf">5386.109843065869</span>  <span class="n">mcmc</span> <span class="n">bounds</span><span class="p">:</span> <span class="p">[</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">32316.659058395213</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">run_sampler</span><span class="p">(</span><span class="n">nwalkers</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">steps</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">progress</span><span class="o">=</span><span class="s1">&#39;notebook&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
<span class="n">mcmc</span> <span class="n">run</span> <span class="n">starting</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0%|          | 0/500 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span> <span class="n">run</span> <span class="n">done</span><span class="p">,</span> <span class="k">with</span> <span class="mi">1</span> <span class="n">threads</span> <span class="n">took</span> <span class="mf">215.38</span> <span class="n">seconds</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mcmc</span><span class="o">.</span><span class="n">acceptance_fraction</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.4015000000000001</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">nu_min</span><span class="o">=</span><span class="mf">1E6</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nu_min</span><span class="o">=</span><span class="mf">1E6</span>
<span class="n">p</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1E11</span><span class="p">,</span> <span class="mf">2E28</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_56_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_56_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">2E11</span><span class="p">,</span> <span class="mf">2E28</span><span class="p">],</span><span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_57_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_57_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">labels</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;beam_obj&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma0_log_parab&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>To have a better rendering on the scatter plot, we redefine the plot
labels</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$N$&#39;</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$B$&#39;</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\delta$&#39;</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$s$&#39;</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">set_plot_label</span><span class="p">(</span><span class="s1">&#39;gamma0_log_parab&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\gamma_0$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>the code below lets you tuning the output:</p>
<ol class="arabic simple">
<li><p>mpl.rcParams[figure.dpi] if you increase it you get a better
definition</p></li>
<li><p>title_fmt=.2E this is the format for python, 2 significant digits,
scientific notation</p></li>
<li><p>title_kwargs=dict(fontsize=12) you can change the fontsize</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">corner_plot</span><span class="p">(</span><span class="n">quantiles</span><span class="o">=</span><span class="p">(</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">),</span><span class="n">title_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span><span class="n">title_fmt</span><span class="o">=</span><span class="s2">&quot;.2E&quot;</span><span class="p">,</span><span class="n">use_math_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_62_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_62_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">corner_plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_63_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_63_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_chain</span><span class="p">(</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_64_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_64_0.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>from the inspection of the corneplot and of the chains, we realize that the bemaing factor distribution is trunctated, and the posterior is not distributed around the best fit value
this suggests that we should rerun the fit changing the starting value and the boundaries according, and rerun the mcmc as well</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">mcmc</span><span class="o">.</span><span class="n">plot_par</span><span class="p">(</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_66_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_66_0.png" />
</section>
<section id="save-and-reuse-mcmc">
<h2>Save and reuse MCMC<a class="headerlink" href="#save-and-reuse-mcmc" title="Link to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;mcmc_sampler.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jetset.mcmc</span> <span class="kn">import</span> <span class="n">McmcSampler</span>
<span class="kn">from</span> <span class="nn">jetset.data_loader</span> <span class="kn">import</span> <span class="n">ObsData</span>
<span class="kn">from</span> <span class="nn">jetset.plot_sedfit</span> <span class="kn">import</span> <span class="n">PlotSED</span>
<span class="kn">from</span> <span class="nn">jetset.test_data_helper</span> <span class="kn">import</span>  <span class="n">test_SEDs</span>

<span class="n">sed_data</span><span class="o">=</span><span class="n">ObsData</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;Mrk_501.pkl&#39;</span><span class="p">)</span>

<span class="n">ms</span><span class="o">=</span><span class="n">McmcSampler</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;mcmc_sampler.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
<span class="o">===&gt;</span> <span class="n">setting</span> <span class="n">C</span> <span class="n">threads</span> <span class="n">to</span> <span class="mi">12</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ms</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">nu_min</span><span class="o">=</span><span class="mf">1E6</span>
<span class="n">ms</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">jet_leptonic</span><span class="o">.</span><span class="n">nu_min</span><span class="o">=</span><span class="mf">1E6</span>
<span class="n">p</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">2E11</span><span class="p">,</span> <span class="mf">2E28</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_70_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_70_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">sed_data</span><span class="o">=</span><span class="n">sed_data</span><span class="p">,</span><span class="n">fit_range</span><span class="o">=</span><span class="p">[</span><span class="mf">2E11</span><span class="p">,</span> <span class="mf">2E28</span><span class="p">],</span><span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">setlim</span><span class="p">(</span><span class="n">y_min</span><span class="o">=</span><span class="mf">1E-14</span><span class="p">,</span><span class="n">x_min</span><span class="o">=</span><span class="mf">1E6</span><span class="p">,</span><span class="n">x_max</span><span class="o">=</span><span class="mf">2E28</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_71_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_71_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_par</span><span class="p">(</span><span class="s1">&#39;beam_obj&#39;</span><span class="p">,</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_72_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_72_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">plot_chain</span><span class="p">(</span><span class="n">log_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/Jet_example_model_fit_wiht_gal_template_73_0.png" src="../../../_images/Jet_example_model_fit_wiht_gal_template_73_0.png" />
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../model_fit_1/Jet_example_model_fit.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Model fitting 1: Only SSC</p>
      </div>
    </a>
    <a class="right-next"
       href="../model_fit_3/Jet_example_model_fit_EC.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Model fitting 3: External Compton</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-data">Loading data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phenomenological-model-constraining">Phenomenological model constraining</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-indices">Spectral indices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed-shaper">Sed shaper</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-constraining">Model constraining</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting-procedure">Model fitting procedure</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting-with-lsb">Model fitting with LSB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting-with-minuit">Model fitting with Minuit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-fitting-with-a-bkn-pl">Model fitting with a bkn pl</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mcmc-sampling">MCMC sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-reuse-mcmc">Save and reuse MCMC</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2019, andrea tramacere.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>